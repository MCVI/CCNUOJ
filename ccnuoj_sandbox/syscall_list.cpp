extern "C" {
#include <sys/syscall.h>
}

#include "common.h"

using namespace std;

map<string, uint64_t> syscall_name_to_id;
map<uint64_t, string> syscall_id_to_name;


#define REGISTER_SYSCALL(name) ( \
	(syscall_name_to_id[#name] = __NR_##name), \
	(syscall_id_to_name[__NR_##name] = #name) \
)


void SyscallList_Init(){
	REGISTER_SYSCALL(read);
	REGISTER_SYSCALL(write);
	REGISTER_SYSCALL(open);
	REGISTER_SYSCALL(close);
	REGISTER_SYSCALL(stat);
	REGISTER_SYSCALL(fstat);
	REGISTER_SYSCALL(lstat);
	REGISTER_SYSCALL(poll);
	REGISTER_SYSCALL(lseek);
	REGISTER_SYSCALL(mmap);
	REGISTER_SYSCALL(mprotect);
	REGISTER_SYSCALL(munmap);
	REGISTER_SYSCALL(brk);
	REGISTER_SYSCALL(rt_sigaction);
	REGISTER_SYSCALL(rt_sigprocmask);
	REGISTER_SYSCALL(rt_sigreturn);
	REGISTER_SYSCALL(ioctl);
	REGISTER_SYSCALL(pread64);
	REGISTER_SYSCALL(pwrite64);
	REGISTER_SYSCALL(readv);
	REGISTER_SYSCALL(writev);
	REGISTER_SYSCALL(access);
	REGISTER_SYSCALL(pipe);
	REGISTER_SYSCALL(select);
	REGISTER_SYSCALL(sched_yield);
	REGISTER_SYSCALL(mremap);
	REGISTER_SYSCALL(msync);
	REGISTER_SYSCALL(mincore);
	REGISTER_SYSCALL(madvise);
	REGISTER_SYSCALL(shmget);
	REGISTER_SYSCALL(shmat);
	REGISTER_SYSCALL(shmctl);
	REGISTER_SYSCALL(dup);
	REGISTER_SYSCALL(dup2);
	REGISTER_SYSCALL(pause);
	REGISTER_SYSCALL(nanosleep);
	REGISTER_SYSCALL(getitimer);
	REGISTER_SYSCALL(alarm);
	REGISTER_SYSCALL(setitimer);
	REGISTER_SYSCALL(getpid);
	REGISTER_SYSCALL(sendfile);
	REGISTER_SYSCALL(socket);
	REGISTER_SYSCALL(connect);
	REGISTER_SYSCALL(accept);
	REGISTER_SYSCALL(sendto);
	REGISTER_SYSCALL(recvfrom);
	REGISTER_SYSCALL(sendmsg);
	REGISTER_SYSCALL(recvmsg);
	REGISTER_SYSCALL(shutdown);
	REGISTER_SYSCALL(bind);
	REGISTER_SYSCALL(listen);
	REGISTER_SYSCALL(getsockname);
	REGISTER_SYSCALL(getpeername);
	REGISTER_SYSCALL(socketpair);
	REGISTER_SYSCALL(setsockopt);
	REGISTER_SYSCALL(getsockopt);
	REGISTER_SYSCALL(clone);
	REGISTER_SYSCALL(fork);
	REGISTER_SYSCALL(vfork);
	REGISTER_SYSCALL(execve);
	REGISTER_SYSCALL(exit);
	REGISTER_SYSCALL(wait4);
	REGISTER_SYSCALL(kill);
	REGISTER_SYSCALL(uname);
	REGISTER_SYSCALL(semget);
	REGISTER_SYSCALL(semop);
	REGISTER_SYSCALL(semctl);
	REGISTER_SYSCALL(shmdt);
	REGISTER_SYSCALL(msgget);
	REGISTER_SYSCALL(msgsnd);
	REGISTER_SYSCALL(msgrcv);
	REGISTER_SYSCALL(msgctl);
	REGISTER_SYSCALL(fcntl);
	REGISTER_SYSCALL(flock);
	REGISTER_SYSCALL(fsync);
	REGISTER_SYSCALL(fdatasync);
	REGISTER_SYSCALL(truncate);
	REGISTER_SYSCALL(ftruncate);
	REGISTER_SYSCALL(getdents);
	REGISTER_SYSCALL(getcwd);
	REGISTER_SYSCALL(chdir);
	REGISTER_SYSCALL(fchdir);
	REGISTER_SYSCALL(rename);
	REGISTER_SYSCALL(mkdir);
	REGISTER_SYSCALL(rmdir);
	REGISTER_SYSCALL(creat);
	REGISTER_SYSCALL(link);
	REGISTER_SYSCALL(unlink);
	REGISTER_SYSCALL(symlink);
	REGISTER_SYSCALL(readlink);
	REGISTER_SYSCALL(chmod);
	REGISTER_SYSCALL(fchmod);
	REGISTER_SYSCALL(chown);
	REGISTER_SYSCALL(fchown);
	REGISTER_SYSCALL(lchown);
	REGISTER_SYSCALL(umask);
	REGISTER_SYSCALL(gettimeofday);
	REGISTER_SYSCALL(getrlimit);
	REGISTER_SYSCALL(getrusage);
	REGISTER_SYSCALL(sysinfo);
	REGISTER_SYSCALL(times);
	REGISTER_SYSCALL(ptrace);
	REGISTER_SYSCALL(getuid);
	REGISTER_SYSCALL(syslog);
	REGISTER_SYSCALL(getgid);
	REGISTER_SYSCALL(setuid);
	REGISTER_SYSCALL(setgid);
	REGISTER_SYSCALL(geteuid);
	REGISTER_SYSCALL(getegid);
	REGISTER_SYSCALL(setpgid);
	REGISTER_SYSCALL(getppid);
	REGISTER_SYSCALL(getpgrp);
	REGISTER_SYSCALL(setsid);
	REGISTER_SYSCALL(setreuid);
	REGISTER_SYSCALL(setregid);
	REGISTER_SYSCALL(getgroups);
	REGISTER_SYSCALL(setgroups);
	REGISTER_SYSCALL(setresuid);
	REGISTER_SYSCALL(getresuid);
	REGISTER_SYSCALL(setresgid);
	REGISTER_SYSCALL(getresgid);
	REGISTER_SYSCALL(getpgid);
	REGISTER_SYSCALL(setfsuid);
	REGISTER_SYSCALL(setfsgid);
	REGISTER_SYSCALL(getsid);
	REGISTER_SYSCALL(capget);
	REGISTER_SYSCALL(capset);
	REGISTER_SYSCALL(rt_sigpending);
	REGISTER_SYSCALL(rt_sigtimedwait);
	REGISTER_SYSCALL(rt_sigqueueinfo);
	REGISTER_SYSCALL(rt_sigsuspend);
	REGISTER_SYSCALL(sigaltstack);
	REGISTER_SYSCALL(utime);
	REGISTER_SYSCALL(mknod);
	REGISTER_SYSCALL(uselib);
	REGISTER_SYSCALL(personality);
	REGISTER_SYSCALL(ustat);
	REGISTER_SYSCALL(statfs);
	REGISTER_SYSCALL(fstatfs);
	REGISTER_SYSCALL(sysfs);
	REGISTER_SYSCALL(getpriority);
	REGISTER_SYSCALL(setpriority);
	REGISTER_SYSCALL(sched_setparam);
	REGISTER_SYSCALL(sched_getparam);
	REGISTER_SYSCALL(sched_setscheduler);
	REGISTER_SYSCALL(sched_getscheduler);
	REGISTER_SYSCALL(sched_get_priority_max);
	REGISTER_SYSCALL(sched_get_priority_min);
	REGISTER_SYSCALL(sched_rr_get_interval);
	REGISTER_SYSCALL(mlock);
	REGISTER_SYSCALL(munlock);
	REGISTER_SYSCALL(mlockall);
	REGISTER_SYSCALL(munlockall);
	REGISTER_SYSCALL(vhangup);
	REGISTER_SYSCALL(modify_ldt);
	REGISTER_SYSCALL(pivot_root);
	REGISTER_SYSCALL(_sysctl);
	REGISTER_SYSCALL(prctl);
	REGISTER_SYSCALL(arch_prctl);
	REGISTER_SYSCALL(adjtimex);
	REGISTER_SYSCALL(setrlimit);
	REGISTER_SYSCALL(chroot);
	REGISTER_SYSCALL(sync);
	REGISTER_SYSCALL(acct);
	REGISTER_SYSCALL(settimeofday);
	REGISTER_SYSCALL(mount);
	REGISTER_SYSCALL(umount2);
	REGISTER_SYSCALL(swapon);
	REGISTER_SYSCALL(swapoff);
	REGISTER_SYSCALL(reboot);
	REGISTER_SYSCALL(sethostname);
	REGISTER_SYSCALL(setdomainname);
	REGISTER_SYSCALL(iopl);
	REGISTER_SYSCALL(ioperm);
	REGISTER_SYSCALL(create_module);
	REGISTER_SYSCALL(init_module);
	REGISTER_SYSCALL(delete_module);
	REGISTER_SYSCALL(get_kernel_syms);
	REGISTER_SYSCALL(query_module);
	REGISTER_SYSCALL(quotactl);
	REGISTER_SYSCALL(nfsservctl);
	REGISTER_SYSCALL(getpmsg);
	REGISTER_SYSCALL(putpmsg);
	REGISTER_SYSCALL(afs_syscall);
	REGISTER_SYSCALL(tuxcall);
	REGISTER_SYSCALL(security);
	REGISTER_SYSCALL(gettid);
	REGISTER_SYSCALL(readahead);
	REGISTER_SYSCALL(setxattr);
	REGISTER_SYSCALL(lsetxattr);
	REGISTER_SYSCALL(fsetxattr);
	REGISTER_SYSCALL(getxattr);
	REGISTER_SYSCALL(lgetxattr);
	REGISTER_SYSCALL(fgetxattr);
	REGISTER_SYSCALL(listxattr);
	REGISTER_SYSCALL(llistxattr);
	REGISTER_SYSCALL(flistxattr);
	REGISTER_SYSCALL(removexattr);
	REGISTER_SYSCALL(lremovexattr);
	REGISTER_SYSCALL(fremovexattr);
	REGISTER_SYSCALL(tkill);
	REGISTER_SYSCALL(time);
	REGISTER_SYSCALL(futex);
	REGISTER_SYSCALL(sched_setaffinity);
	REGISTER_SYSCALL(sched_getaffinity);
	REGISTER_SYSCALL(set_thread_area);
	REGISTER_SYSCALL(io_setup);
	REGISTER_SYSCALL(io_destroy);
	REGISTER_SYSCALL(io_getevents);
	REGISTER_SYSCALL(io_submit);
	REGISTER_SYSCALL(io_cancel);
	REGISTER_SYSCALL(get_thread_area);
	REGISTER_SYSCALL(lookup_dcookie);
	REGISTER_SYSCALL(epoll_create);
	REGISTER_SYSCALL(epoll_ctl_old);
	REGISTER_SYSCALL(epoll_wait_old);
	REGISTER_SYSCALL(remap_file_pages);
	REGISTER_SYSCALL(getdents64);
	REGISTER_SYSCALL(set_tid_address);
	REGISTER_SYSCALL(restart_syscall);
	REGISTER_SYSCALL(semtimedop);
	REGISTER_SYSCALL(fadvise64);
	REGISTER_SYSCALL(timer_create);
	REGISTER_SYSCALL(timer_settime);
	REGISTER_SYSCALL(timer_gettime);
	REGISTER_SYSCALL(timer_getoverrun);
	REGISTER_SYSCALL(timer_delete);
	REGISTER_SYSCALL(clock_settime);
	REGISTER_SYSCALL(clock_gettime);
	REGISTER_SYSCALL(clock_getres);
	REGISTER_SYSCALL(clock_nanosleep);
	REGISTER_SYSCALL(exit_group);
	REGISTER_SYSCALL(epoll_wait);
	REGISTER_SYSCALL(epoll_ctl);
	REGISTER_SYSCALL(tgkill);
	REGISTER_SYSCALL(utimes);
	REGISTER_SYSCALL(vserver);
	REGISTER_SYSCALL(mbind);
	REGISTER_SYSCALL(set_mempolicy);
	REGISTER_SYSCALL(get_mempolicy);
	REGISTER_SYSCALL(mq_open);
	REGISTER_SYSCALL(mq_unlink);
	REGISTER_SYSCALL(mq_timedsend);
	REGISTER_SYSCALL(mq_timedreceive);
	REGISTER_SYSCALL(mq_notify);
	REGISTER_SYSCALL(mq_getsetattr);
	REGISTER_SYSCALL(kexec_load);
	REGISTER_SYSCALL(waitid);
	REGISTER_SYSCALL(add_key);
	REGISTER_SYSCALL(request_key);
	REGISTER_SYSCALL(keyctl);
	REGISTER_SYSCALL(ioprio_set);
	REGISTER_SYSCALL(ioprio_get);
	REGISTER_SYSCALL(inotify_init);
	REGISTER_SYSCALL(inotify_add_watch);
	REGISTER_SYSCALL(inotify_rm_watch);
	REGISTER_SYSCALL(migrate_pages);
	REGISTER_SYSCALL(openat);
	REGISTER_SYSCALL(mkdirat);
	REGISTER_SYSCALL(mknodat);
	REGISTER_SYSCALL(fchownat);
	REGISTER_SYSCALL(futimesat);
	REGISTER_SYSCALL(newfstatat);
	REGISTER_SYSCALL(unlinkat);
	REGISTER_SYSCALL(renameat);
	REGISTER_SYSCALL(linkat);
	REGISTER_SYSCALL(symlinkat);
	REGISTER_SYSCALL(readlinkat);
	REGISTER_SYSCALL(fchmodat);
	REGISTER_SYSCALL(faccessat);
	REGISTER_SYSCALL(pselect6);
	REGISTER_SYSCALL(ppoll);
	REGISTER_SYSCALL(unshare);
	REGISTER_SYSCALL(set_robust_list);
	REGISTER_SYSCALL(get_robust_list);
	REGISTER_SYSCALL(splice);
	REGISTER_SYSCALL(tee);
	REGISTER_SYSCALL(sync_file_range);
	REGISTER_SYSCALL(vmsplice);
	REGISTER_SYSCALL(move_pages);
	REGISTER_SYSCALL(utimensat);
	REGISTER_SYSCALL(epoll_pwait);
	REGISTER_SYSCALL(signalfd);
	REGISTER_SYSCALL(timerfd_create);
	REGISTER_SYSCALL(eventfd);
	REGISTER_SYSCALL(fallocate);
	REGISTER_SYSCALL(timerfd_settime);
	REGISTER_SYSCALL(timerfd_gettime);
	REGISTER_SYSCALL(accept4);
	REGISTER_SYSCALL(signalfd4);
	REGISTER_SYSCALL(eventfd2);
	REGISTER_SYSCALL(epoll_create1);
	REGISTER_SYSCALL(dup3);
	REGISTER_SYSCALL(pipe2);
	REGISTER_SYSCALL(inotify_init1);
	REGISTER_SYSCALL(preadv);
	REGISTER_SYSCALL(pwritev);
	REGISTER_SYSCALL(rt_tgsigqueueinfo);
	REGISTER_SYSCALL(perf_event_open);
	REGISTER_SYSCALL(recvmmsg);
	REGISTER_SYSCALL(fanotify_init);
	REGISTER_SYSCALL(fanotify_mark);
	REGISTER_SYSCALL(prlimit64);
	REGISTER_SYSCALL(name_to_handle_at);
	REGISTER_SYSCALL(open_by_handle_at);
	REGISTER_SYSCALL(clock_adjtime);
	REGISTER_SYSCALL(syncfs);
	REGISTER_SYSCALL(sendmmsg);
	REGISTER_SYSCALL(setns);
	REGISTER_SYSCALL(getcpu);
	REGISTER_SYSCALL(process_vm_readv);
	REGISTER_SYSCALL(process_vm_writev);
	REGISTER_SYSCALL(kcmp);
	REGISTER_SYSCALL(finit_module);
	REGISTER_SYSCALL(sched_setattr);
	REGISTER_SYSCALL(sched_getattr);
	REGISTER_SYSCALL(renameat2);
	REGISTER_SYSCALL(seccomp);
	REGISTER_SYSCALL(getrandom);
	REGISTER_SYSCALL(memfd_create);
	REGISTER_SYSCALL(kexec_file_load);
	REGISTER_SYSCALL(bpf);
	REGISTER_SYSCALL(execveat);
	REGISTER_SYSCALL(userfaultfd);
	REGISTER_SYSCALL(membarrier);
	REGISTER_SYSCALL(mlock2);
	REGISTER_SYSCALL(copy_file_range);
	REGISTER_SYSCALL(preadv2);
	REGISTER_SYSCALL(pwritev2);
	REGISTER_SYSCALL(pkey_mprotect);
	REGISTER_SYSCALL(pkey_alloc);
	REGISTER_SYSCALL(pkey_free);
	REGISTER_SYSCALL(statx);
}
